\documentclass[a4paper,11pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{fancyhdr}
\usepackage[spanish]{babel}
\usepackage{lastpage}
\usepackage{amstext}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{etoolbox}
\usepackage{wasysym}
\usepackage{xfrac}
\usepackage{fancyvrb}
\usepackage[implicit=false]{hyperref}
\usepackage[a4paper, total={6.5in, 9.5in}]{geometry}
\usepackage[T1]{fontenc}
\usepackage[sc]{mathpazo}

\newcommand{\at}{@}

\title{Teoría de Números\\
      \small{Práctica 1}}
\author{Lucio Santi\\
        \texttt{lsanti\at dc.uba.ar}}
\date{\today}

\pagestyle{fancyplain} 
\renewcommand{\headrulewidth}{0pt}
\cfoot{\thepage/\pageref{LastPage}}
\lhead{}
\chead{}
\rhead{}

\newcommand{\ZZ}{\ensuremath{\mathbb{Z}}}
\newcommand{\Zm}[1]{\ensuremath{\mathbb{Z}[#1]}}
\newcommand{\Cong}[3]{\ensuremath{#1 \equiv #2 \, \textrm{mod } #3}}
\newcommand{\Div}[2]{\ensuremath{#1 | #2}}
\newcommand{\mcd}[2]{\ensuremath{\textrm{mcd}\left(#1, #2\right)}}
\newcommand{\Leg}[2]{\left(\frac{#1}{#2}\right)}


\newtheorem*{ej}{Ejercicio}

\begin{document}
\maketitle

\begin{ej} 
    Asumiendo que el anillo \Zm{\alpha = \frac{1 + \sqrt{-19}}{2}} es DFU, probar que $(x, y) = (\pm 18, 7)$
son las únicas soluciones enteras de la ecuación

    $$x^2 + 19 = y^3$$
\end{ej}

\begin{proof}[Resoluci\'on]
Si factorizamos $x^2 + 19$ en \Zm{\alpha}, tenemos
\begin{eqnarray*}
    x^2 + 19 &=& (x + \sqrt{-19}) (x - \sqrt{-19}) \\
             &=& \left((x-1) + 2\alpha \right) \left((x+1) - 2\alpha\right) \\
             &=& \beta \dot \gamma
\end{eqnarray*}

Consideremos un
$\delta = a + b \alpha \in \Zm{\alpha}$
tal que $\Div{\delta}{\beta}$ y $\Div{\delta}{\gamma}$. Luego, se tiene que
$$\Div{\delta}{\left((x-1) + 2\alpha \right) - \left((x+1) - 2\alpha\right)} = -2 + 4\alpha = 2 (-1 + 2\alpha) = \eta$$

Puesto que \Zm{\alpha} es un dominio de factorización única, $\eta$ es expresable como producto de primos
de forma única (salvo asociados). Por ende, supongamos que $\delta$ es un divisor primo de $\eta$. De esta forma,
$\Div{\delta}{2}$ o bien $\Div{\delta}{-1 + 2\alpha}$, de lo que sigue que 
$\Div{N(\delta)}{N(2) = 4}$ o bien \Div{N(\delta)}{N(-1 + 2\alpha) = 19}, siendo $N(u + v \alpha) = u^2 + uv + 5v^2$
la norma de \Zm{\alpha}. Observemos que, como función de $u$, $f(u) = N(u + v_0\alpha) = u^2 + uv_0 + 5v_0^2$ es
decreciente hasta $u = \sfrac{-v_0}{2}$, donde alcanza su mínimo, y luego creciente. De esta forma,
$$N(u + v\alpha) = u^2 + uv + 5v^2 \geq \left(\sfrac{-v}{2}\right)^2 + \left(\sfrac{-v}{2}\right) \, v + 5v^2 = \sfrac{19}{4} \, v^2$$

Además, si buscamos que $\Div{\delta}{2}$ o que \Div{\delta}{-1 + 2\alpha}, necesariamente debe ocurrir 
que $b \neq 0$ si nos proponemos encontrar divisores no triviales.
Así, $N(\delta) \geq \sfrac{19}{4} > 4$, por lo que $\delta$ no puede ser un divisor no trivial de $2$
en \Zm{\alpha}. Por otro lado, siempre que $|b| > 2$, $N(\delta) > 19$, de manera que $b = \pm 2$.
No obstante, en tales casos los únicos valores de $\delta$
posibles son precisamente $-1 + 2\alpha$ y $1 - 2\alpha$. En consecuencia, puesto que 
$\delta = \pm (-1 + 2\alpha)$ no puede ser divisor simultáneo de $\beta$ y de $\gamma$,
se tiene que $\beta$ y $\gamma$ son coprimos en \Zm{\alpha} o bien el único divisor primo que comparten
es $2$. En el primer caso, deben ser $\beta$ y $\gamma$ cubos simultáneamente de forma tal de satisfacer
la ecuación deseada. En particular, deben existir ciertos $c, d \in \mathbb{Z}$ tales que
\begin{eqnarray*}
    \beta = (x-1) + 2\alpha &=& (c + d \alpha)^3 \\
          &=& \left(c^3 - 5d^3 - 15cd^2 \right) + \left(3c^2d - 4d^3 + 3cd^2 \right) \alpha
\end{eqnarray*}
de lo que, por unicidad de escritura, sigue que
$$d (3c^2 - 4d^2 + 3cd) = 2$$
y esto vale si y sólo si $d = 1$ y $c \in \{1, -2\}$. De esta forma, 
$$x = 1 + c^3 - 5d^3 - 15cd^2 \in \{-18, 18\}$$
lo cual permite concluir que, en cualquier caso, $y = 7$ reemplazando en la ecuación original.

Finalmente, si $\beta$ y $\gamma$ comparten a 2 como único divisor común primo, es posible considerar
$\beta'= 2\beta$ y $\gamma' = \frac{\gamma}{2}$ siendo así $\beta'$ y $\gamma'$ coprimos en \Zm{\alpha}
(notar que $\gamma' = \frac{x+1}{2} - \alpha$ no es divisible por $2$).
A través de un razonamiento similar al anterior, puede arribarse a la conclusión de que no existe una
forma de expresar como cubo en \Zm{\alpha} a $\gamma'$. Por ende, esto termina de probar que las 
únicas soluciones posibles a la ecuación planteada son las descriptas anteriormente.
\end{proof}


\begin{ej} 
Caracterizaremos los primos que son suma de dos cuadrados. Probaremos que, si $p$ es un
primo impar, entonces $p = x^2 + y^2$ si y sólo si $\Cong{p}{1}{4}$.

\begin{enumerate}[i.]
    \item Sea $p$ primo impar tal que $p$ se escribe como suma de dos cuadrados.
    Probar que -1 es un cuadrado módulo $p$. Concluir que $\Cong{p}{1}{4}$.

    \item Sea $p$ primo impar, $\Cong{p}{1}{4}$. Tomar $n \in \mathbb{Z}$ tal que
    $\Cong{n^2}{-1}{p}$. Como $\Div{p}{n^2 + 1}$ en $\mathbb{Z}$, tenemos que
    $\Div{p}{(n + i)(n - i)}$ en \Zm{i}. Probar que $p$ no es primo de \Zm{i} y, 
    por lo tanto, es reducible.

    \item Sabiendo que $p = \alpha \cdot \beta$, $\alpha, \beta \in \Zm{i}$ no 
    unidades, concluir que $p$ es suma de dos cuadrados.
\end{enumerate}

\end{ej}

\begin{proof}[Resoluci\'on]
$ $

\begin{enumerate}[i.]

\item Sea $p$ primo impar tal que $p = x^2 + y^2$ para ciertos $x, y \in \ZZ$.
Como $p$ es impar,
debe ser \Cong{x}{0}{2} y \Cong{y}{1}{2} o viceversa. Sin pérdida de generalidad, tomemos
entonces \Cong{x}{0}{2} y \Cong{y}{1}{2}. Observemos que \Cong{x^2}{0}{4} y 
\Cong{y^2}{1}{4}. Veamos cuánto vale el símbolo de Legendre de $-1$:
\begin{eqnarray*}
    \Leg{-1}{p} &=& (-1)^{\frac{p-1}{2}} \\
                &=& (-1)^{\frac{x^2 + y^2 - 1}{2}} \\
                &=& (-1)^{\frac{x^2}{2}} \, (-1)^{\frac{y^2 - 1}{2}} \\
                &=& 1
\end{eqnarray*}
De esta manera, queda probado que $-1$ es un cuadrado módulo $p$. Como consecuencia, 
debe ser necesariamente \Cong{p}{1}{4} pues, en caso contrario, $\Leg{-1}{p} \neq 1$.

\item Sea $p$ primo impar, $\Cong{p}{1}{4}$, y sea $n \in \ZZ$ tal que 
$\Cong{n^2}{-1}{p}$ (un tal $n$ debe existir puesto que $\Leg{-1}{p} = 1$). Como
$\Div{p}{n^2 + 1}$ en \ZZ, se tiene que $\Div{p}{(n + i)(n - i)}$ en \Zm{i}.
Supongamos que $p$ es primo en \Zm{i}. Luego, $\Div{p}{n+i}$ o bien
$\Div{p}{n-i}$. En el primer caso, se tiene que $n + i = p \gamma$ para cierto
$\gamma = a + bi \in \Zm{i}$. Luego, $n + i = pa + pbi$, con lo cual debe ser
$1 = pb$, lo cual es un absurdo puesto que $p, b \in \ZZ$ y $p > 1$. El otro caso
puede argumentarse de manera análoga. Por ende, $p$ no puede ser primo en \Zm{i} y,
por lo tanto, no es irreducible (siendo \Zm{i} un DFU).

\item En el contexto del ítem anterior, tenemos que $p = \alpha \cdot \beta$, 
con $\alpha, \beta \in \Zm{i}$ no unidades. Luego,
$$N(p) = N(\alpha \cdot \beta) = N(\alpha) N(\beta)$$
Considerando $\alpha = a + bi$ y $\beta = c + di$ para ciertos $a,b,c,d \in \ZZ$,
tenemos entonces
$$p^2 = (a^2 + b^2) (c^2 + d^2)$$
Al ser $p$ primo en \ZZ, tenemos las siguientes posibilidades:
\begin{itemize}
    \item $a^2 + b^2 = 1$ y $c^2 + d^2 = p^2$,
    \item $a^2 + b^2 = p^2$ y $c^2 + d^2 = 1$, o bien
    \item $a^2 + b^2 = p$ y $c^2 + d^2 = p$
\end{itemize}
Observar que los dos primeros casos no pueden suceder puesto que, de ser así,
$\alpha$ o $\beta$ serán una unidad de \Zm{i}. Luego, del último ítem se 
desprende lo que buscábamos.

\end{enumerate}

\end{proof}


\begin{ej} 
Caracterización de los irreducibles de \Zm{i}.

\begin{enumerate}[i.]
    \item  Probar que $2 = (-i)(1+i)^2$ y que $1+i$ es irreducible.

    \item Sea \Cong{p}{3}{4}. Probar que $p = x^2 + y^2$ no tiene soluciones
    en $\mathbb{Z}$. Concluir que $p$ es irreducible en \Zm{i}.

    \item Utilizar el ejercicio anterior para probar que, si \Cong{p}{1}{4}, entonces
    $p$ se factoriza en \Zm{i} como producto de dos irreducibles no asociados.

    \item Probar que, si $\pi$ es un irreducible de \Zm{i}, entonces $\pi$ es asociado
    a alguno de los irreducibles mencionados en los ítems anteriores (sug.: si $\pi$ es
    irreducible, existe un primo $p \in \mathbb{Z}$ tal que \Div{p}{N(\pi) = \pi \bar{\pi}}
    y usar factorización única).
\end{enumerate}
\end{ej}

\begin{proof}[Resoluci\'on]
TBD
\end{proof}

\begin{ej} 
Factorizar como producto de irreducibles los elementos $7 + 4i$ y $23 + 14i$ en \Zm{i}.
\end{ej}

\begin{proof}[Resoluci\'on]
Inmediato usando SageMath \smiley:

\begin{center}
\begin{minipage}{6.8cm}
    \begin{Verbatim}[frame=single,fontsize=\footnotesize]
    sage: K.<i> = QuadraticField(-1)
    sage: factor(7 - 4*i)
    (i) * (-i - 2) * (2*i + 3)
    sage: factor(23+14*i)
    (-i - 2)^2 * (-2*i + 5)    
    \end{Verbatim}
\end{minipage}
  \end{center}

\end{proof}

\end{document}
